GOOGLE_PROJECT_ID=organic-387603
CLOUD_RUN_SERVICE=organic-api-service
INSTANCE_CONNECTION_NAME=organic-387603:asia-southeast2:organicdbmysql
DB_USER=admindb
DB_PASS=mpg1161#
DB_NAME=userDB
ACCESS_TOKEN_SECRET=9af42de397cfc9387a06972c28c23a1ac7e9a60fb6dc1f05295bc67baf500672d4a13db5d04ea84bbc4c5679164a7723f3d49f516bb73dc3df6e3b768c8e
REFRESH_TOKEN_SECRET=a6d157ad7d2ee09e480960ae857e528ae546d156f47433b1afad1611c45aa520697b65d13a5c72891f6145ab1f2675886fc124027dc95f86073dd8fe1462

gcloud builds submit --tag gcr.io/$GOOGLE_PROJECT_ID/$CLOUD_RUN_SERVICE \
    --project=$GOOGLE_PROJECT_ID

gcloud run deploy $CLOUD_RUN_SERVICE \
    --image gcr.io/$GOOGLE_PROJECT_ID/$CLOUD_RUN_SERVICE \
    --add-cloudsql-instances $INSTANCE_CONNECTION_NAME \
    --update-env-vars INSTANCE_CONNECTION_NAME=$INSTANCE_CONNECTION_NAME,DB_USER=$DB_USER,DB_PASS=$DB_PASS,DB_NAME=$DB_NAME,ACCESS_TOKEN_SECRET=$ACCESS_TOKEN_SECRET,REFRESH_TOKEN_SECRET=$REFRESH_TOKEN_SECRET \
    --platform managed \
    --region asia-southeast2 \
    --allow-unauthenticated \
    --project=$GOOGLE_PROJECT_ID